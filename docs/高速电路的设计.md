---
id: 高速电路的设计
title: 高速电路的设计 🚧
---

## 高速 PCB 设计需考虑因素

- 成本控制
- 叠层排布原则
- 布局原则
- 布线原则
- 阻抗设计
- 信号完整性
- 电源完整性
- EMC 设计
- 热设计
- DFM 设计

## 两层板与多层板的区别

- 参考平面与阻抗的计算
- 多层板回流路径更短
- 更容易布线
- 多层板成本高

## 叠层规范

- 元件、焊接面为完整的地平面（屏蔽作用）
- 尽可能的无相邻平行布线层（避免互相干扰）
- 所有信号层尽可能与地平面相邻；关键信号与地层相邻，不跨分割区（减小回流路径）

综上，可参考的叠层方案是：

- 顶层：信号 1
- 中间 1 层：地
- 中间 2 层：电源
- 底层：信号 2

为了减少边沿辐射，电源层要相对地层内缩（pullback）1 mm 以上。

## 不同通信协议的 PCB 阻抗设计要求

| 高速信号   | 阻抗要求 | 误差 | 走线 |
| ---------- | -------- | ---- | ---- |
| DDR        | 100Ω     | ±10% |      |
| eMMC       | 50Ω      | ±10% |      |
| PCIe       |          |      |      |
| USB        | 90Ω      | ±10% | 差分 |
| HDMI       | 100Ω     | ±10% |      |
| eDP        | 90Ω      | ±10% | 差分 |
| MIPI       | 100Ω     | ±10% | 差分 |
| SDIO/SDMMC | 50Ω      | ±10% |      |

## 一些基本概念

- **信号完整性（Signal Integrity）**：信号完整性是指信号在信号线上的质量。信号具有良好的信号完整性是指当在需要的时候具有所必需达到的电压电平数值。
- **传输线（Transmission Line）**：由两个具有一定长度的导体组成回路的连接线，我们称之为传输线，有时也被称为延迟线。它的电流返回到地或电源。传输线的基本特性是特性阻抗和信号的传输延迟。
- **集总电路（Lumped circuit）**：在一般的电路分析中，电路的所有参数，如阻抗、容抗、感抗都集中于空间的各个点上，各个元件上，各点之间的信号是瞬间传递的，这种理想化的电路模型称为集总电路。
- **分布式系统（Distributed System）**：实际的电路情况是各种参数分布于电路所在空间的各处，当这种分散性造成的信号延迟时间与信号本身的变化时间相比已不能忽略的时侯，整个信号通道是带有电阻、电容、电感的复杂网络，这就是一个典型的分布参数系统。
- **上升/下降时间（Rise/Fall Time）**：信号从低电平跳变为高电平所需要的时间，通常是量度上升/下降沿在 10%-90% 电压幅值之间的持续时间，记为 Tr。
- **截止频率（Knee Frequency）**：这是表征数字电路中集中了大部分能量的频率范围（0.5/Tr），记为 Fknee，一般认为超过这个频率的能量对数字信号的传输没有任何影响。
- **特征阻抗（Characteristic Impedance）**：交流信号在传输线上传播中的每一步遇到不变的瞬间阻抗就被称为特征阻抗，也称为浪涌阻抗，记为 Z0。可以通过传输线上输入电压对输入电流的比率值（V/I）来表示。
- **传输延迟（Propagation delay）**：指信号在传输线上的传播延时，与线长和信号传播速度有关，记为 tPD。
- **趋肤效应（Skin effect）**：指当信号频率提高时，流动电荷会渐渐向传输线的边缘靠近，甚至中间将没有电流通过。与此类似的还有集束效应，现象是电流密集区域集中在导体的内侧。
- **反射（Reflection）**：指由于阻抗不匹配而造成的信号能量的不完全吸收，发射的程度可以有反射系数 ρ 表示。
- **过冲/下冲（Over shoot/under shoot）**：过冲就是指接收信号的第一个峰值或谷值超过设定电压 —— 对于上升沿是指第一个峰值超过最高电压；对于下降沿是指第一个谷值超过最低电压，而下冲就是指第二个谷值或峰值。
- **振荡**：在一个时钟周期中，反复出现过冲和下冲，我们就称之为振荡。振荡根据表现形式可分为振铃（Ringing）和环绕振荡，振铃为欠阻尼振荡，而环绕振荡为过阻尼振荡。
- **阻抗匹配（Termination）**：指为了消除反射而通过添加电阻或电容器件来达到阻抗一致的效果。因为通常采用在源端或终端，所以也称为端接。
- **振铃**
  - 振铃效应（Ringingeffect）就是影响复原图像质量的众多因素之一，其典型表现是在图像灰度剧烈变化的临域出现类吉布斯（Gibbs）分布的震荡。
  - 振铃现象，来源于变压器漏感和寄生电容引起的阻尼振荡。由于变压器的初级有漏感，当电源开关管由饱和导通到截止关断时会产生反电动势，反电动势又会对变压器初级线圈的分布电容进行充放电，从而产生阻尼振荡，即产生振铃。变压器初级漏感产生反电动势的电压幅度一般都很高，其能量也很大，如不采取保护措施，反电动势一般都会把电源开关管击穿，同时反电动势产生的阻尼振荡还会产生很强的电磁辐射，不但对机器本身造成严重干扰，对机器周边环境也会产生严重的电磁干扰。
- **串扰**：串扰是指当信号在传输线上传播时，因电磁耦合对相邻的传输线产生的不期望的电压噪声干扰，这种干扰是由于传输线之间的互感和互容引起的。
- **信号回流（Return current）**：指伴随信号传播的返回电流。
- **自屏蔽（Self shielding）**：信号在传输线上传播时，靠大电容耦合抑制电场，靠小电感耦合抑制磁场来维持低电抗的方法称为自屏蔽。
- **前向串扰（Forward Crosstalk）**：指干扰源对牺牲源的接收端产生的第一次干扰，也称为远端干扰（Far-end crosstalk）。
- **后向串扰（Forward Crosstalk）**：指干扰源对牺牲源的发送端产生的第一次干扰，也称为近端干扰（Near-end crosstalk）。
- **屏蔽效率（SE）**：是对屏蔽的适用性进行评估的一个参数，单位为分贝。吸收损耗：吸收损耗是指电磁波穿过屏蔽罩的时候能量损耗的数量。
- **反射损耗**：反射损耗是指由于屏蔽的内部反射导致的能量损耗的数量，他随着波阻和屏蔽阻抗的比率而变化。
- **校正因子**：表示屏蔽效率下降的情况的参数，由于屏蔽物吸收效率不高，其内部的再反射会使穿过屏蔽层另一面的能量增加，所以校正因子是个负数，而且只使用于薄屏蔽罩中存在多个反射的情况分析。
- **差模 EMI**：传输线上电流从驱动端流到接收端的时候和它回流之间耦合产生的 EMI，就叫做差模 EMI。
- **共模 EMI**：当两条或者多条传输线以相同的相位和方向从驱动端输出到接收端的时候，就会产生共模辐射，既共模 EMI。
- **发射带宽**：即最高频率发射带宽，当数字集成电路从逻辑高低之间转换的时候，输出端产生的方波信号频率并不是导致 EMI 的唯一成分。该方波中包含频率范围更宽广的正弦谐波分量，这些正弦谐波分量是工程师所关心的 EMI 频率成分，而最高的 EMI 频率也称为 EMI 的发射带宽。
- **电磁环境**：存在于给定场所的所有电磁现象的总和。
- **电磁骚扰**：任何能引起装置、设备或系统性能降低或者对有生命或者无生命物质产生损害作用的电磁现象。
- **电磁干扰**：电磁骚扰引起设备、传输通道和系统性能的下降。
- **电磁兼容性**：设备或者系统在电磁环境中能正常工作且不对该环境中任何事物构成不能承受的电磁骚扰的能力。
- **系统内干扰**：系统中出现由本系统内部电磁骚扰引起的电磁干扰。
- **系统间干扰**：有其他系统产生的电磁干扰对一个系统造成的电磁干扰。
- **静电放电**：具有不同静电电位的物体相互接近或者接触时候而引起的电荷转移。
- **建立时间（Setup Time）**：建立时间就是接收器件需要数据提前于时钟沿稳定存在于输入端的时间。
- **保持时间（Hold Time）**：为了成功的锁存一个信号到接收端，器件必须要求数据信号在被时钟沿触发后继续保持一段时间，以确保数据被正确的操作。这个最小的时间就是我们说的保持时间。
- **飞行时间（Flight Time）**：指信号从驱动端传输到接收端，并达到一定的电平之间的延时，和传输延迟和上升时间有关。
- **Tco**：是指器件的输入时钟边缘触发有效到输出信号有效的时间差，这是信号在器件内部的所有延迟总和，一般包括逻辑延迟和缓冲延迟。缓冲延迟（buffer delay）：指信号经过缓冲器达到有效的电压输出所需要的时间
- **抖动（Jitter）**：信号的某特定时刻从其理想时间位置上的短期偏离为抖动。
- **时钟抖动（Clock Jitter）**：时钟抖动是指时钟触发沿的随机误差，通常可以用两个或多个时钟周期之间的差值来量度，这个误差是由时钟发生器内部产生的，和后期布线没有关系。
- **时钟偏移（Skew）**：是指由同样的时钟产生的多个子时钟信号之间的延时差异。
- **钟**: 假时钟是指时钟越过阈值（threshold）无意识地改变了状态（有时在 VIL 或 VIH 之间）。通常由于过分的下冲（undershoot）或串扰（crosstalk）引起。
- **电源完整性（Power Integrity）**： 指电路系统中的电源和地的质量。
- **同步开关噪声（Simultaneous Switch Noise）**：指当器件处于开关状态，产生瞬间变化的电流（di/dt），在经过回流途径上存在的电感时，形成交流压降，从而引起噪声，简称 SSN。也称为 Δi 噪声。
- **地弹（Ground Bounce）**：指由于封装电感而引起地平面的波动，造成芯片地和系统地不一致的现象。同样，如果是由于封装电感引起的芯片和系统电源差异，就称为电源反弹（Power Bounce）。
- **PLL（Phase Locked Loops，锁相环路**）：一种反馈控制系统，也是闭环跟踪系统，其输出信号的频率跟踪输入信号的频率。当输出信号频率与输入信号频率相等时，输出电压与输入电压保持固定的相位差值。它由鉴相器（PD， Phase Detector）、环路滤波器（LP， Loops Filter）、和压控振荡器（VCO， Voltage Control Oscillator）三部分组成。
- **CRU（Clock Recovery Unit，时钟恢复单元）**：当需要测试一个高速串行信号眼图时，需要一个时钟恢复单元，从被测信号中恢复出. 事实上，一个真实的高速器件内部就有一个时钟恢复单元。
- **ISI（Inter-Symbol interference，码间干扰）**：不同长度的连续“1”与“0”在带宽有限的系统中受到不同的衰减，导致长连续的“1”或“0”到达比短“1”与短“0”更高的电平，在接续这些长“1”或长“0”后的跳变，信号需要比短“1”与短“0”更多的时间才能到达门限电平，这些时间上的偏离就导致信号的抖动，不同长短“1”与“0”之间的干扰导致数据相关抖动即 ISI。
- **DCD（Data dependant distortion，数据信赖失真、占空比失真）**：因上升沿速率与下降沿速率的不对称性所造成的时钟周期上的偏离，即占空比失真。
- **眼图**：一些列数字信号在示波器上累积而显示的图形。它包含丰富的信息，体现了数字信号的整体特征，能够很好的评估数字信号的品质，因而眼图分析是高速互联系统信号完整性分析的核心。

## 参考与致谢

- [高速信号 PCB 设计](https://blog.infonet.io/2021/04/04/%E9%AB%98%E9%80%9F%E4%BF%A1%E5%8F%B7PCB%E8%AE%BE%E8%AE%A1/)
- [高速电路设计很难学？熟悉这 48 个基本概念，你就入门了](http://murata.eetrend.com/article/2019-07/1002919.html)

> 原文地址：<https://wiki-power.com/>  
> 本篇文章受 [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh) 协议保护，转载请注明出处。

