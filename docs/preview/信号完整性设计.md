---
id: 信号完整性设计
title: 信号完整性设计
---

## 什么是信号完整性

信号完整性（Signal Integrity，SI）是指信号在信号线上的质量。信号具有良好的信号完整性是指当在需要的时候具有所必需达到的电压电平数值。

在低速数字电路中，0/1 电平拥有比模拟电路高得多的抗噪声能力。但随着电路工作频率变高，承载 0/1 电平的电压或电流波形会出现畸变，从而导致接收的信息出现错误，这就是信号完整性（Signal Intergrity，SI）问题。在涉及高速信号的设计时，需要考虑信号完整性问题。

## 带状线和微带线

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211126145234.png)

### 微带线

微带线（Micro-Strip）指的是只有一边存在参考平面的传输线。微带线特性阻抗由导线的厚度、宽度、基材厚度及介电常数决定。主要用于双层和多层板。

因为微带线在电路板外层，接触空气，所以介电损耗低于带状线，信号传输速度快。它的制造难度低，成本更低。但也因为在外层，所以少了一些内置保护，并且会对外辐射更多的能量。

### 带状线

带状线（Strip-Line）指的是两边都有参考平面的内层传输线。根据与两接地平面的距离相同或不同，又分为对称与非对称带状线。带状线的特性阻抗由导线的厚度、宽度、介电常数，及接地平面的距离有关。带状线两边都有电源或者底层，因此阻抗容易控制，同时屏蔽较好。

因为带状线是嵌在两层导体之间，所以它的电场分布都在两个包它的导体（平面）之间，不会辐射出去能量，也不会受到外部的辐射干扰。但是由于它的周围全是电介质（介电常数比 1 大），所以信号在带状线中的传输速度比在微带线中的慢。

## 信号质量问题

常见的信号质量问题表现在下面几个方面：

### 毛刺

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220093321.png)

毛刺的危害是容易造成控制信号控制错误，或时钟信号相位发生错误：

1. 数据线上的毛刺如果被采样到，可能造成判断结果错误；
2. 边沿触发的器件中，时钟线上的毛刺可能会使得采样到多余的数据（多了一拍时钟信号）。

毛刺的产生原因是：

1. PCB 走线串扰（例如数据线和时钟线平行走线长度太大，信号线经过晶振等干扰源附近）；
2. 外界干扰，比如地线上的噪声；
3. 逻辑出现竞争、冒险。

解决毛刺的方法是：

1. 控制器件布局和 PCB 走线，信号远离干扰源；
2. 添加去耦电容或输出滤波电容。滤波器件尽量靠近信号管脚；
3. 逻辑设计中添加冗余项，或者采用同步逻辑设计，避免竞争冒险。

如果负向毛刺时始终落在高电平判决门限以上，那么没有什么影响（因为始终会被判断为高电平）；如果正向毛刺始终落在低电平判决门限以下，那么没有什么影响（因为始终会被判断为低电平）。

### 回勾 / 台阶

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220092811.png)

回沟的危害：

1. 时钟类信号上的回勾，可能会使得采样到多余的数据（多一拍时钟），影响了时钟信号上升沿和下降沿的单调性；
2. 电源信号上电边沿的回勾可能导致系统死机，需要结合复位信号判断能够接受此回勾；
3. 数据信号由于一般是在数据的中间采样，回勾的影响不是很大（除非速率很高，建立保持的时间又很短）

回勾的产生原因是阻抗匹配不当，信号反射回来形成的。

解决回勾的方法是增加合适的匹配阻抗（一般来讲，对于单端信号，单板内信号可以加 33Ω 电阻始端匹配，板间信号加 200Ω 电阻匹配较合适）。

回勾始终落在高电平判决门限以上（或者始终落在低电平判决门限以下），那就没什么影响，因为会时钟被判断为高电平（低电平）。

### 信号边沿缓慢

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220093258.png)

信号边沿缓慢的危害是会造成数据采样错误（发生在数据信号线如串口等）。

信号边沿缓慢的产生原因是驱动能力不够，或者负载过大（例如链路阻抗太大）。

解决信号边沿缓慢的方法是：

1. 提高驱动能力；
2. 减小负载。

由于驱动不足或者负载过大，信号边沿缓慢也常伴随着信号幅度较低的现象。

### 振荡（回冲 / 振铃）

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220094236.png)

回冲指多次跨越电平临界值，而振铃指经过多次反复才回归正常电平。

回冲 / 振铃的危害类似于多次过冲，在高低电平之间是一种不确定的状态。

回冲 / 振铃的产生原因是阻抗匹配不当（过大或国小）。

解决方法是更改为合适的匹配电阻（阻抗）。

### 建立 / 保持时间不当

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220100245.png)

建立时间（$t_{SU}$，setup time））就是指在触发器的采样信号（一般指时钟）有效之前，数据已经稳定不变的时间；保持时间（$t_{HO}$，hold time）是指采样信号有效之后数据保持稳定不变的时间。

建立时间不够的危害是，读到的数据会是一个不稳定的数据，可能会造成采样错误；保持时间不够，读写数据处理过程中同样可能读写到错误数据。

建立 / 保持时间不当产生的原因是设计时没计算恰当，或者没有考虑到设计容限范围，也有可能是因为元器件温漂导致。

解决方法是，对于时钟边沿采样信号，尽量使得采样时钟边沿在数据的中间，这样尽管器件参数漂移，设计上还是有较大的裕度。

### 电磁辐射

电磁辐射（EMI）的问题可跳转文章 [**EMC 设计指南**](https://wiki-power.com/EMC%E8%AE%BE%E8%AE%A1%E6%8C%87%E5%8D%97)。

## 🚧 待整理知识

- 所有的信号互联都是传输线
- 信号的阻抗是损失阻抗
- 一般来说，要尽量要减小环路
- 阻抗：任何时刻 Z=V/I
- 阻抗计算工具：IS9000

## 参考与致谢

- 《信号完整性揭秘-于博士 SI 设计手记》
- [What Every PCB Designer Should Know - Crosstalk Explained (with Eric Bogatin)](https://www.youtube.com/watch?v=EF7SxgcDfCo)
- 《硬件信号质量 SI 测试规范》
- [传输线串扰分析](https://blog.csdn.net/weixin_40877615/article/details/95329866)

> 原文地址：<https://wiki-power.com/>  
> 本篇文章受 [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by/4.0/deed.zh) 协议保护，转载请注明出处。


---

### 反射

反射是传输线特性阻抗或终端电阻不匹配引发的，会引起信号的反射。造成的危害是，过冲、下冲、振铃。

#### 过冲

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211220091443.png)

过冲分为正负过冲。他们共同的危害是闩锁损伤器件（>VCC 或 \<GND），对器件冲击造成器件损坏。其中，正过冲会形成干扰源，对其他器件造成串扰；负过冲导致管脚上的负电压使器件 PN 衬底（寄生二极管）前向偏置，大电流会熔断产生开路。

过冲的产生原因有：

1. 其它相邻信号串扰；
2. 器件驱动能力太强；
3. 阻抗没有匹配 / 匹配不当。

解决过冲的方法是：

1. PCB 布线避开干扰源和耦合路径；
2. 增加电阻匹配，参考做法是始端串电阻或者末端并阻抗（电阻），减少过冲。

### 损耗 / 延时

传输线长度不当会造成传输延时与损耗。造成的危害是，损耗造成电压幅值变小，延时造成时序雨量不足。

### 串扰

一根信号线上有信号通过时，在 PCB 板上与之相邻的信号线上就会感应出相关的信号，我们称之为串扰。串扰通常表现为毛刺。串扰是传输线之间相互的寄生电感产生耦合引发的，带来的危害是使信号畸变。

串扰分为近端（NEXT）串扰与远端串扰（FEXT）。

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211014143734.png)

如图可见，上方信号线传过来了一个跳变的信号，在粉色的区域内，两根导线靠得很近（不符合 3W 原则），所以会产生串扰。下方的导线是受干扰的线。

在跳变信号进入干扰区域（粉色区域）时，开始发生串扰：

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211014144817.png)

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211014145322.png)

可以观察到，**由于干扰源在移动，且同时向两个方向发出**，所以随着时间的推进，与信号同向的干扰波形会叠加，而与信号反向波形高度保持不变。

当跳变信号传出干扰区域后，受干扰线上的凸起波形开始消失，并向各自的方向推进：

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211014145143.png)

最终，在近端 / 远端接收的干扰如下：

![](https://wiki-media-1253965369.cos.ap-guangzhou.myqcloud.com/img/20211014150220.png)

减少串扰的方法：

- 增加走线间距：3W 原则
- 信号线距离地线距离拉近
- 减小平行走线的耦合长度
- 增大信号的上升时间或下降时间：在时序条件允许的情况下，这可以减少高频信号所带来的影响
- 合理采用端接匹配技术：减弱甚至消耗信号的反射，从而减弱串扰强度。
